(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-db16b790"],{2175:function(e,t,n){},"7ae3":function(e,t,n){},"7d8e":function(e,t,n){"use strict";var a=n("f251"),o=n.n(a);o.a},"8f91":function(e,t,n){"use strict";var a=n("7ae3"),o=n.n(a);o.a},cb74:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("crud")]),n("crud",{attrs:{data:e.data,columns:e.columns,formColumns:e.formColumns,formData:e.formData,rules:e.rules,onUpdateForm:e.handleUpdateForm,onCreateForm:e.handleCreateForm,onDeleteRow:e.handleDeleteRow,pageConfig:e.pageConfig,rowActionsWidth:300,hasBatchDelBtn:!0},on:{"on-change":e.handlePageChange},scopedSlots:e._u([{key:"append-row-actions",fn:function(t){var a=t.row;return[n("span",[e._v("添加rowAction"+e._s(a.name))])]}}])},[n("template",{slot:"left-actions"},[n("span",[e._v("append left")])]),n("template",{slot:"right-actions"},[n("span",[e._v("append right")])])],2)],1)},o=[],r=(n("96cf"),n("3b8d")),i=(n("7f7f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"crud"},[n("Row",{attrs:{type:"flex",justify:"space-between",align:"middle","class-name":"header-actions"}},[n("Col",{attrs:{xs:24,sm:24,md:12}},[e.hasAddBtn?n("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.handleAdd}},[e._v("添加")]):e._e(),e.hasBatchDelBtn?n("Button",{attrs:{type:"error",icon:"md-trash"},on:{click:e.handleBatchDelete}},[e._v("批量删除")]):e._e(),e.hasExportCsvBtn?n("Button",{attrs:{type:"warning",icon:"md-download"},on:{click:e.handleExportCsv}},[e._v("导出csv")]):e._e(),e._t("left-actions")],2),n("Col",[e._t("right-actions")],2)],1),n("Table",e._g(e._b({ref:"crud-table",attrs:{data:e.data,columns:e.columns,loading:e.loading},scopedSlots:e._u([{key:"row-actions",fn:function(t){var a=t.row;return[n("div",{staticClass:"row-actions"},[e._t("rewrite-row-actions",[e.hasRowEditBtn?n("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]):e._e(),e.hasRowDelBtn?n("Button",{attrs:{type:"error",size:"small"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")]):e._e()],{row:a}),e._t("append-row-actions",null,{row:a})],2)]}}],null,!0)},"Table",this.$attrs,!1),e.tableListeners)),e.pageConfig?n("Row",{staticStyle:{margin:"15px 0"},attrs:{type:"flex",justify:"end"}},[n("Page",e._g(e._b({},"Page",e.pageConfig,!1),e.pageListeners))],1):e._e(),n("EditModal",{ref:"edit-modal"})],1)}),s=[],l=(n("20d6"),n("7514"),n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.splitedColumns,function(t,a){return n("Row",{key:a,staticClass:"expand-row"},e._l(t,function(t){return n("Col",{key:t.key,attrs:{span:"8"}},[n("span",{staticClass:"expand-key"},[e._v(e._s(t.key))]),n("span",{staticClass:"expand-value"},[e._v(e._s(t.value))])])}),1)}),1)}),c=[],u={inject:["data","columns"],props:{row:Object,expandedColumns:{type:Array,default:function(){return[]}},colNum:{type:Number,default:3}},computed:{splitedColumns:function(){for(var e=this,t=[],n=-1,a=function(a){a%e.colNum===0&&(t[++n]=[]);var o=e.expandedColumns[a],r=void 0,i=void 0;if("string"===typeof o){var s=e.columns.find(function(e){return e.key===o});r=s.title,i=e.row[o]}else{if(o.label)r=o.label;else{var l=e.columns.find(function(e){return e.key===o.key});r=l&&l.title||o.key}i=o.value?"function"===typeof o.value?o.value(o.key,e.row):o.value:e.row[o.key]}t[n].push({key:r,value:i,span:Math.floor(24/e.colNum)})},o=0;o<this.expandedColumns.length;o++)a(o);return t}}},d=u,p=(n("e7ae"),n("2877")),f=Object(p["a"])(d,l,c,!1,null,"16c9ae6f",null),m=f.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{title:(this.editRow?"更新":"创建")+"表单",width:"50%"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("EditForm",{ref:"edit-form",attrs:{loading:e.submiting},on:{"close-modal":e.closeModal}}),n("template",{slot:"footer"},[n("Button",{attrs:{type:"primary",loading:e.submiting},on:{click:e.handleSubmit}},[e._v(e._s(this.editRow?"更新":"提交"))]),n("Button",{on:{click:e.closeModal}},[e._v("取消")])],1)],2)},g=[],v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{ref:"form",attrs:{model:e.formData,"label-width":70,rules:e.rules,"label-position":"right"}},e._l(e.columns,function(t,a){return n("Row",{key:a,attrs:{"class-name":"form-row",gutter:10}},e._l(t,function(t){return n("Col",{key:t.label,attrs:{xs:e.xs,sm:e.xs,md:e.md}},[n("FormItem",{attrs:{label:t.label,prop:t.prop}},[e.isDefaultType(t.type)?n("Input",{attrs:{type:t.type,placeholder:"请输入"+t.label+"...",disabled:e.loading},model:{value:e.formData[t.prop],callback:function(n){e.$set(e.formData,t.prop,n)},expression:"formData[col.prop]"}}):e._e(),"select"===t.type?n("Select",{attrs:{clearable:"",disabled:e.loading},model:{value:e.formData[t.prop],callback:function(n){e.$set(e.formData,t.prop,n)},expression:"formData[col.prop]"}},e._l(t.dicts,function(t){return n("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1):e._e(),"date"===t.type||"datetime"===t.type?n("DatePicker",{attrs:{type:t.type,format:t.format||"",placeholder:"请选择"+t.label,disabled:e.loading},model:{value:e.formData[t.prop],callback:function(n){e.$set(e.formData,t.prop,n)},expression:"formData[col.prop]"}}):e._e(),"file"===t.type||"image"===t.type?n("Upload",e._b({},"Upload",t.uploadConfig,!1),[n("div",{staticClass:"inner-upload"},["image"===t.type&&e.formData[t.prop]?n("img",{staticClass:"upload-image",attrs:{src:e.formData[t.prop]}}):e._e(),n("Icon",{class:["upload-icon",{"default-visible":!e.formData[t.prop]}],attrs:{type:"ios-cloud-upload",size:"20"}})],1)]):e._e()],1)],1)}),1)}),1)},y=[],b=(n("8e6e"),n("456d"),n("ac6a"),n("bd86"));function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(n,!0).forEach(function(t){Object(b["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var x={name:"crud-form",inject:["formData","onCreateForm","onUpdateForm","rules","formColumns"],props:["loading"],data:function(){return{colNum:2,md:12,xs:24,columns:[],isEdit:!1}},created:function(){this.initConfig()},methods:{initConfig:function(){for(var e=[],t=-1,n=0;n<this.formColumns.length;n++){n%this.colNum===0&&(e[++t]=[]);var a=this.formColumns[n];e[t].push(C({},a,{dicts:a.dicts||[]}))}this.columns=e},initForm:function(e){var t=this;this.isEdit=!!e,e&&Object.keys(e).forEach(function(n){var a=t.formColumns.find(function(e){return e.prop===n});a&&a.type&&a.type.indexOf("time")>-1?t.formData[n]=new Date(e[n]):t.formData[n]=e[n]})},submit:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs["form"].validate();case 2:if(t=e.sent,!t){e.next=18;break}if(e.prev=4,!this.isEdit){e.next=10;break}return e.next=8,this.onUpdateForm(this.formData);case 8:e.next=12;break;case 10:return e.next=12,this.onCreateForm(this.formData);case 12:this.$emit("close-modal"),e.next=18;break;case 15:throw e.prev=15,e.t0=e["catch"](4),e.t0;case 18:case"end":return e.stop()}},e,this,[[4,15]])}));function t(){return e.apply(this,arguments)}return t}(),clearForm:function(){this.$refs["form"].resetFields()},isDefaultType:function(e){var t=["select","date","datetime","file","image"],n=t.find(function(t){return t===e});return!n}}},_=x,k=(n("7d8e"),Object(p["a"])(_,v,y,!1,null,"06b956a5",null)),D=k.exports,O={name:"crud-form-modal",components:{EditForm:D},data:function(){return{visible:!1,submiting:!1,editRow:null}},methods:{openModal:function(e){this.editRow=e,this.$refs["edit-form"].initForm(e),this.visible=!0},closeModal:function(){this.$refs["edit-form"].clearForm(),this.visible=!1},handleSubmit:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.submiting=!0,e.next=4,this.$refs["edit-form"].submit();case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e["catch"](0),e.t0;case 9:return e.prev=9,this.submiting=!1,e.finish(9);case 12:case"end":return e.stop()}},e,this,[[0,6,9,12]])}));function t(){return e.apply(this,arguments)}return t}()}},j=O,B=Object(p["a"])(j,h,g,!1,null,null,null),F=B.exports,R=function(e,t){var n={};return Object.assign(n,e),t.forEach(function(e){delete n[e]}),n},E=function(e,t){var n={};return t.forEach(function(t){void 0!==e[t]&&(n[t]=e[t])}),n},$={name:"crud",inheritAttrs:!1,components:{CrudExpandRow:m,EditModal:F},props:{data:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},formColumns:{type:Array,default:function(){return[]}},formData:{type:Object,default:function(){return{}}},rules:{type:Object,default:function(){return{}}},hasRowDelBtn:{type:Boolean,default:!0},hasRowEditBtn:{type:Boolean,default:!0},hasBatchDelBtn:{type:Boolean,default:!0},hasAddBtn:{type:Boolean,default:!0},hasExportCsvBtn:{type:Boolean,default:!0},exportCsvConfig:{type:Object,default:function(){return{}}},pageConfig:{type:Object},onCreateForm:Function,onUpdateForm:Function,onDeleteRow:Function,onBatchDelete:Function,rowActionsWidth:Number,rowActionsFixed:String},data:function(){return{parsedColumns:[],pageListeners:E(this.$listeners,["on-change","on-page-size-change"]),tableListeners:R(this.$listeners,["on-change","on-page-size-change"])}},provide:function(){return{onCreateForm:this.onCreateForm,onUpdateForm:this.onUpdateForm,formData:this.formData,rules:this.rules,formColumns:this.formColumns,data:this.data,columns:this.columns}},created:function(){this.init()},methods:{init:function(){this.initColumns()},initColumns:function(){var e=this.columns;if(!e.find(function(e){return"row-actions"===e.slot})){var t={title:"操作",slot:"row-actions",align:"center",width:this.rowActionsWidth||150};this.rowActionsFixed&&(t.fixed=this.rowActionsFixed),e.push(t)}this.hasBatchDelBtn&&!e.find(function(e){return"selection"===e.type})&&e.unshift({type:"selection",width:50});var n=e.findIndex(function(e){return"expand"===e.type});n>-1&&!e[n].render&&Object.assign(e[n],{render:function(t,a){var o=a.row;return t(m,{props:{row:o,expandedColumns:e[n].expandedColumns,colNum:e[n].colNum}})}}),this.parsedColumns=e},handleEdit:function(e){this.$refs["edit-modal"].openModal(e)},handleAdd:function(){this.$refs["edit-modal"].openModal()},handleDelete:function(e){var t=this;this.$Modal.confirm({title:"警告",content:"确定删除该行数据吗？",onOk:function(){t.onDeleteRow(e)}})},handleBatchDelete:function(){var e=this;this.$Modal.confirm({title:"警告",content:"确定删除这些数据吗？",onOk:function(){e.onBatchDelete()}})},handleExportCsv:function(){this.$refs["crud-table"].exportCsv(this.exportCsvConfig)}}},A=$,P=(n("8f91"),Object(p["a"])(A,i,s,!1,null,"407a3112",null)),M=P.exports,N=M,U={name:"crud-table",components:{crud:N},data:function(){var e=this,t=function(t,n,a){console.log("testValidator",{name:e.formData.name}),""===n?a(new Error("Please enter something")):a()};return{data:[{id:123,name:"张三",age:12,type:"学生",avatar:"https://cn.vuejs.org/images/logo.png"},{id:1234,name:"李四",age:22,type:"老师",avatar:"https://cn.vuejs.org/images/logo.png"}],columns:[{type:"expand",width:50,expandedColumns:["name",{label:"年龄2",key:"age"},{label:"类型",key:"type",value:function(e,t){return t[e]}},"avatar"],colNum:3},{title:"id",key:"id"},{title:"名字",key:"name"},{title:"年龄",key:"age"},{title:"类型",key:"type"},{title:"头像",key:"avatar"}],formData:{name:"",age:"",type:"学生",avatar:""},formColumns:[{label:"名字",prop:"name"},{label:"年龄",prop:"age"},{label:"类型",prop:"type",type:"select",dicts:[{label:"学生",value:"学生"},{label:"老师",value:"老师"}]},{label:"头像",prop:"avatar",type:"image",uploadConfig:{action:"https://www.baidu.com","on-error":function(t,n,a){console.log(e),console.log({error:t,file:n,fileList:a})}}}],rules:{name:[{required:!0,message:"必须填写"}],age:[{validator:t,trgger:"change"}]},pageConfig:{total:10,current:2,"page-size":5,"show-total":!0}}},methods:{handleUpdateForm:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log(t),console.log(this.formData.name);case 2:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),handleCreateForm:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log(this.formData);case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),handleDeleteRow:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log(t);case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),handlePageChange:function(e){console.log(e)}}},S=U,z=Object(p["a"])(S,a,o,!1,null,null,null);t["default"]=z.exports},e7ae:function(e,t,n){"use strict";var a=n("2175"),o=n.n(a);o.a},f251:function(e,t,n){}}]);